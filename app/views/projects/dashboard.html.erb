<figure>
  <code id="cover-image" style="display: none;"></code>
  <img class="cover-img" data-embed-id="cover-image" alt="Mastercard cover image" src="https://images.unsplash.com/photo-1533562179840-9cce77549aa6?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1600&h=400&fit=crop&ixid=eyJhcHBfaWQiOjF9&s=461c16b2ba620b62655c9c0ad08ddd78">
</figure>

<div class="container">
  <div class="col-md-12">
    <div class="comments green-box">
      <h2>Project info </h2>
     </div>
    <div class="project-info white-box">
      <p>Project name:<%= @project.name %></p>
      <p>Charity:<%= @charity.name %></p>
      <p>Status: <%= @project.status  %></p>
      <p>Type: <%= @project.work_type %></p>
    </div>
  </div>


  <div class="col-md-12">
    <div class="comments green-box">
      <h2>Charity info </h2>
    </div>
    <div class="charity-info-dashboard white-box">
      <p>Logo: <%= @project.charity.logo %></p>
      <p>Location:<%= @project.charity.address %></p>
      <p>Email: <%= @project.charity.email %></p>
      <p>Website: <%= @project.charity.website %></p>
      <p>Category: <%= @project.charity.category %></p>
    </div>
  </div>


  <div class="col-md-12">
    <div class="comments green-box">
      <h2> Skills requiered </h2>
    </div>
    <div class="skills-info white-box">
      <div class="stat">
        <div class="stat-content">
          <% @skills.each do |skill| %>
            <li><%= skill.name %> <%= link_to "Remove", project_project_skill_path(@project, skill) , method: :delete %> </li>
          <% end %>
        </div>
      </div>
    </div>
  </div>


  <div class="col-md-12">
    <div class="comments green-box">
      <h3>Team Members: </h3>
    </div>
    <div class="team-info white-box">
      <div class = "row">
        <% @project.developers.each do |developer| %>
          <div class="col-md-4  text-center">
            <p><%= developer.avatar %></p>
            <p>Name: <%= developer.first_name %> <%= developer.last_name %></p>
            <p>Email: <%= developer.email %></p>
            <p><%= developer.github_username %></p>
            <% if @project.leader_id == developer.id %>
              <h4> LEADER </h4>
            <% end %>
             <!-- if user can see the button && delete a member -->
            <%= policy(member).destroy? %>
            <%= link_to "Remove from the team", project_member_path(@project, developer), method: :delete, class: 'btn btn-warning', data: { confirm: "Are you sure?" } %>
          </div>
        <% end %>
      </div>
    </div>
  </div>


  <div class="col-md-12">
      <div class="comments green-box">
        <h3>New join requests: </h3>
      </div>
    <div class="applications-info white-box">
        <div class = "row">
          <% @proposals.each do |proposal| %>
            <div class="col-md-4 text-center">
              <p><%= link_to proposal.developer.first_name, developer_path(proposal.developer) %></p>
              <p><%= proposal.state%></p>
              <!-- if user can see the buttons && autorize proposal-->
              <% if proposal.state == "Pending" || "pending" &&  policy(proposal).accept? %>
                <%= link_to "Accept ", accept_proposal_path(proposal: proposal), method: :post, class: 'btn btn-success' %>
                <%= link_to "Reject", reject_proposal_path(proposal: proposal), method: :post, class: 'btn  btn-danger' %>
              <% end %>
              <br> <br> <br>
          </div>
        <% end %>
      </div>
    </div>
  </div>


  <div class="col-md-12">
    <div class="comments green-box">
       <h2> Comments: </h2>
    </div>
    <div class="comments white-box">
      <ul class="post-list">
        <div class = "row">
          <div class = "col-md-6">
            <p>Content</p>
          </div>
          <div class = "col-md-2">
            <p>Developer</p>
          </div>
          <div class = "col-md-2">
            <p>Created on</p>
          </div>
        </div>
        <% if @posts %>
          <% @posts.each do |post| %>
            <% if post.project == @project %>
              <div class = "row">
                <li class="">
                  <div class = "col-md-6">
                    <%= post.content %>
                  </div>
                  <div class = "col-md-2">
                    <%= post.developer.first_name %>
                  </div>
                  <div class = "col-md-2">
                    <%= post.created_at.strftime("%FT%T") %>
                  </div>
                </li>
              </div>
            <% end %>
          <% end %>
        <% end %>
      </ul>
      <div class= "post-footer">
        <button type="button" class="btn btn-success text-right" data-toggle="modal" data-target=".bs-example-modal-lg">Add a post</button>
      </div>
    </div>
  </div>


  <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            <span aria-hidden="true">&times;</span>
            <span class="sr-only">Close</span>
          </button>
          <h4 class="modal-title" id="myModalLabel">Post a comment</h4>
        </div>

        <div class="modal-body">
          <%= simple_form_for [@project, Post.new] do |f| %>
            <%= f.input :content %>
        </div>
        <div class="modal-footer form-inline">
            <%= f.submit "Post", class: "btn btn-primary" %>
          <% end %>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>

